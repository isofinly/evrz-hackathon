{"embedding": [0.23126113414764404, -0.8918289542198181, -1.208367109298706, 0.8281059861183167, 0.5757349133491516, -0.5287550687789917, 0.40837210416793823, 0.6044130325317383, -0.3025698959827423, 0.0025897175073623657, 0.3180941045284271, -0.23469515144824982, 0.21422076225280762, 0.03201817721128464, -0.0731811672449112, 0.2867186963558197, 0.13353422284126282, 0.09546496719121933, 0.6729198694229126, -0.527888834476471, -0.010875138454139233, 0.3234765827655792, 0.20584943890571594, -0.05420217290520668, 0.13958342373371124, 0.5325658321380615, 0.4818328619003296, -0.3298855721950531, 0.7102450132369995, -0.3104023039340973, 0.5603476166725159, 0.1921609789133072, 1.0201973915100098, 0.6870426535606384, 0.1681790053844452, -0.33937451243400574, -0.02806912548840046, 0.26936182379722595, -1.7254910469055176, 0.014292160049080849, -0.5649476647377014, 0.32877013087272644, 0.716722846031189, -0.3609478175640106, 0.5167115330696106, 1.1003425121307373, -0.4350537657737732, 0.5993227958679199, -0.19096536934375763, 0.46624282002449036, 0.771159827709198, 0.1427357792854309, -0.3505152761936188, 0.19648104906082153, 0.05966467037796974, 0.2690867781639099, -0.568350076675415, 0.7323049306869507, -0.17782704532146454, -0.3624625504016876, 0.4948514699935913, 0.13806860148906708, 0.46884939074516296, -0.6266072392463684, 0.05846134200692177, -0.006710313260555267, -0.24849173426628113, -0.15266503393650055, 0.026872286573052406, 0.6107102632522583, -0.41925957798957825, -0.437877357006073, 0.23695480823516846, 0.21512115001678467, 0.40267106890678406, 0.05760679394006729, 0.23759539425373077, -0.08282630145549774, 0.2789202034473419, 0.43125811219215393, 1.1167736053466797, -0.8203552961349487, -0.03078746423125267, -0.32742103934288025, 0.06418316811323166, 0.2590938210487366, 0.6143819689750671, -0.9596962332725525, -0.5750024914741516, -0.1474592387676239, -0.5222843289375305, 0.22646699845790863, -0.2757818400859833, -0.3973936438560486, 0.15646402537822723, -0.48151955008506775, -0.583307683467865, -0.6136539578437805, -0.5560142397880554, 0.07610034197568893, -0.5451197028160095, 0.4844174087047577, 0.33120545744895935, 0.04773370549082756, 1.1151559352874756, -0.6065681576728821, 0.29194045066833496, -0.3756416141986847, -0.08475948870182037, -0.044522419571876526, -0.07461284101009369, -0.4398844540119171, -0.6883115768432617, 0.5431808829307556, -0.013766740448772907, -0.4186065196990967, -0.2709619104862213, 0.17433790862560272, 0.625557005405426, -0.51632159948349, 0.07523661851882935, -0.48817387223243713, -0.14372645318508148, -0.4236869513988495, 1.0978877544403076, 0.3132113218307495, 0.3574647903442383, -0.09085528552532196, -0.09644964337348938, -0.016504229977726936, -0.7273860573768616, 0.2771662175655365, -0.20555077493190765, 0.691618800163269, -0.4305449426174164, 0.05516377091407776, 0.17322774231433868, -0.00010815938003361225, -0.14101442694664001, 0.535760760307312, 0.05616781860589981, 0.23108871281147003, 0.2712427079677582, -0.49762558937072754, -0.3146607577800751, -0.06740535795688629, -0.2003486454486847, -0.40356165170669556, -0.019885538145899773, -0.011261388659477234, 0.26507410407066345, -0.39836856722831726, 0.17746151983737946, 0.6301962733268738, 0.20651352405548096, 0.05261518806219101, -0.26041704416275024, -0.3169918358325958, -0.34963908791542053, 0.2692874073982239, 0.11550406366586685, -0.14077502489089966, 0.019814500585198402, -0.24586433172225952, 0.21952056884765625, -0.014950511045753956, -0.18990568816661835, -0.012070570141077042, -0.014192106202244759, 0.48401615023612976, -0.16087855398654938, 0.10973133146762848, -0.09575537592172623, -0.06568539142608643, 0.497576504945755, 0.65486741065979, 0.19301658868789673, -0.3173837661743164, 0.23041263222694397, -0.2494959980249405, 0.0027738655917346478, -0.3672366142272949, 0.5989916920661926, 0.3298150599002838, 0.17064815759658813, 0.9502634406089783, -0.23497264087200165, 0.47108641266822815, 0.4208206534385681, 0.1298619508743286, 0.1339849829673767, -0.19177794456481934, -0.04524094983935356, -0.6196014881134033, -0.7104718089103699, -0.09826286137104034, 0.11281692981719971, -0.5838686227798462, 0.4506177008152008, 0.5142830610275269, -0.7527400255203247, -0.5074787139892578, 0.6138918995857239, -0.01856784150004387, 0.1186332181096077, 0.3213517665863037, 0.526721715927124, 0.20289793610572815, -1.1303876638412476, 0.2899945080280304, -0.4891405701637268, 0.31243911385536194, -0.3873547613620758, -0.08381626009941101, 0.4760153591632843, -0.1998894214630127, 0.14337235689163208, 0.46700695157051086, -0.2705596685409546, 0.3856997489929199, 0.3480106592178345, 0.7126546502113342, -0.9950124621391296, -0.10596374422311783, 0.32534199953079224, -0.09149692207574844, 0.5755825042724609, 0.03799958527088165, -0.8398691415786743, 0.25386732816696167, -0.6146698594093323, 0.31862133741378784, 0.39818575978279114, 0.4899016320705414, -0.3150632381439209, 0.012890197336673737, 0.5239955186843872, 0.03578777238726616, -0.27368712425231934, -0.09172015637159348, 0.2909972369670868, -0.330048143863678, -0.07899690419435501, -0.060066819190979004, -0.7604765892028809, -0.5561376214027405, -0.0880591943860054, -0.2043514996767044, 0.08462513983249664, -0.8581623435020447, 0.3054342567920685, 0.6018672585487366, -0.31738680601119995, 0.17777231335639954, 0.06084171682596207, -0.34167101979255676, -0.2366490662097931, -0.35072198510169983, -0.015866782516241074, -0.12826316058635712, -0.24745924770832062, -0.8319134712219238, 0.13779158890247345, 0.39860740303993225, -0.16774815320968628, -0.4597500264644623, -0.14572758972644806, -0.0822175070643425, -0.1626264750957489, 0.04428742453455925, 1.0065666437149048, 0.508966863155365, -0.5633677244186401, -0.06277850270271301, 0.03761185705661774, -0.26771947741508484, -0.08949299901723862, 0.31152039766311646, -0.05441787838935852, -0.27447837591171265, -0.0653541088104248, -0.5088675618171692, 0.8449070453643799, 0.05909848213195801, 0.8656737804412842, -0.005181821063160896, -0.03530694171786308, 0.44656866788864136, -0.6996276378631592, 0.08269554376602173, 0.06690467149019241, 0.438478946685791, -0.5022737383842468, -0.47085103392601013, -0.42159196734428406, 0.03515050932765007, -1.6630418300628662, -0.1262013018131256, 0.9177461266517639, -0.13987021148204803, -0.824225127696991, 0.7156504988670349, 0.7739793658256531, -0.03354605659842491, -0.236845001578331, -0.5987860560417175, 0.4554968476295471, -0.4664263129234314, -0.07293477654457092, 0.2465532124042511, 0.44092828035354614, 0.003582741366699338, -0.48685961961746216, 0.22182996571063995, 0.49815091490745544, 0.4332045614719391, -0.025367677211761475, 0.8883975148200989, 0.006860183086246252, 0.48193874955177307, -0.17995965480804443, 0.5092014670372009, 0.23714616894721985, 0.13269293308258057, 0.9642389416694641, -0.8609247207641602, 0.07903040200471878, 0.3121483027935028, -0.2109854519367218, 0.08023682981729507, -0.6731093525886536, 0.4691332280635834, -0.207683727145195, 0.08328571915626526, -0.39652013778686523, -0.11015032976865768, -0.10759437829256058, -1.2466374635696411, 0.6032159328460693, 0.4268030524253845, 0.40597862005233765, -0.3660120666027069, 0.30338844656944275, -0.028035113587975502, -0.8952697515487671, -0.26502570509910583, 1.184178113937378, -0.2617266774177551, 0.3686016798019409, -0.5594116449356079, -0.15303605794906616, -0.3570796847343445, 0.28865671157836914, -0.2393711805343628, 0.19066929817199707, -1.2173185348510742, -0.3138454854488373, -0.6673982739448547, -0.3295080363750458, -0.2795238792896271, -0.25820907950401306, 0.5899356603622437, -0.27754339575767517, 0.43471720814704895, -0.3483193516731262, -0.02736857160925865, -0.1839810460805893, -0.07688096165657043, -0.30280691385269165, -0.3896567225456238, -0.11247462034225464, -0.11475293338298798, -0.32465797662734985, -0.008448228240013123, 0.7757454514503479, 0.01391234528273344, -0.24520426988601685, -0.13397657871246338, -0.5752730369567871, 0.18797184526920319, 0.08221983909606934, 0.7072071433067322, -0.3412870764732361, -0.19405008852481842, -0.22515106201171875, -0.3120867908000946, -0.007892409339547157, 0.02494366466999054, -0.42920568585395813, 0.24185331165790558, 0.28796467185020447, -0.14914853870868683, 0.2568613588809967, -0.01937440223991871, -0.41641488671302795, -0.10466205328702927, -0.11937643587589264, 0.39835846424102783, 0.5427745580673218, -0.22629483044147491, 0.20284976065158844, -0.15654051303863525, -0.20626422762870789, 0.6348198056221008, 0.0122757563367486, -0.08100651949644089, 0.8545452952384949, 0.8824147582054138, 0.14244158565998077, 0.7172655463218689, -0.6743966937065125, -0.36978501081466675, 0.017548933625221252, 0.38902968168258667, 0.050317466259002686, 0.06955377012491226, 0.18508267402648926, -0.37504494190216064, -0.2385525107383728, 0.7847945094108582, 0.15398342907428741, 0.5484830141067505, 0.46492815017700195, -0.21720659732818604, -0.42589184641838074, -0.8127511143684387, 0.12411481142044067, -0.35914507508277893, -0.8106865882873535, 0.2751239836215973, 0.4961598515510559, 0.5533647537231445, -0.21824802458286285, -0.6447562575340271, 0.2611503005027771, -0.23802651464939117, -0.001797823584638536, -0.3965436518192291, -0.014029189012944698, 0.28617507219314575, 0.2466498762369156, -0.20268869400024414, -0.14294157922267914, -0.06869969516992569, 0.23974375426769257, -0.2771756947040558, -0.3278805613517761, 0.722989559173584, 0.9630770683288574, 0.010867021046578884, -0.5354052186012268, 0.31060096621513367, -0.165410578250885, -0.3731546998023987, -0.3200949430465698, -0.6664683818817139, 0.6309027075767517, -0.41803818941116333, -0.2525634765625, -0.5376508235931396, 0.07606574147939682, 0.10709292441606522, 0.2959159314632416, -0.578838586807251, -0.007562963757663965, 0.35209783911705017, 0.5723066926002502, -0.054481446743011475, -0.4432709515094757, -0.2555352747440338, 0.4950365424156189, 0.04829644039273262, -0.3115716874599457, -0.09419761598110199, 0.33401504158973694, 0.0628490149974823, 0.2626749277114868, 0.22898712754249573, -0.32810473442077637, -0.2894010841846466, 0.8685131669044495, -0.30182474851608276, 0.20932045578956604, 0.15790647268295288, 0.04926973581314087, -0.5347787737846375, 0.5599976778030396, 0.022658975794911385, 0.5850151181221008, -0.5825883746147156, 0.5348422527313232, 0.02849944680929184, -0.05318639054894447, 0.11925015598535538, -0.7913476824760437, -0.27004075050354004, -0.5280534029006958, 0.3935317397117615, 0.24817493557929993, -0.22055043280124664, 0.5827980041503906, -1.1305018663406372, -0.4383288025856018, 0.143439382314682, 0.024711253121495247, 0.3894449472427368, -0.6230034828186035, -0.5162873864173889, 0.3205507695674896, -0.04401117190718651, -0.5293750166893005, 0.267728716135025, 0.23748017847537994, -0.024278413504362106, 0.13532447814941406, 0.3939970135688782, -0.3425256609916687, 0.8709008097648621, 0.22776374220848083, -0.3663386404514313, 0.02405521832406521, -0.7347813844680786, 0.8028742074966431, -0.09578561037778854, -0.18559081852436066, -0.15154466032981873, -0.5434486269950867, -0.3773074746131897, 0.78946453332901, 0.1190648227930069, -0.2746891379356384, -0.08619554340839386, -0.24733945727348328, -0.7998205423355103, 0.08267544955015182, 0.6299635767936707, -0.20289109647274017, -0.6623259782791138, -0.048418376594781876, -0.16608214378356934, -0.23326851427555084, 0.5334109663963318, -0.5684504508972168, -0.02364995703101158, -0.3801018297672272, -0.5151060819625854, -0.18072974681854248, -0.4586901068687439, 0.6743457317352295, -1.0140644311904907, -0.4284023642539978, 0.13884390890598297, 0.8580695390701294, 0.20379570126533508, -0.4902867078781128, -0.0016976335318759084, 0.4018711745738983, -0.8550348281860352, 0.14308667182922363, -0.08151938766241074, 0.22893649339675903, 0.6218512058258057, -0.14432621002197266, 0.157076895236969, 0.17847877740859985, 0.12310268729925156, 0.6684239506721497, 0.24226967990398407, -0.1111413761973381, -0.13010503351688385, -0.09074831008911133, 0.3568912744522095, 0.4112541973590851, -0.03399587795138359, 0.04692171886563301, -0.10643572360277176, -0.018010880798101425, 0.08393185585737228, 0.5064752697944641, -0.5882604122161865, 0.6789408922195435, -0.5681008696556091, 0.19929298758506775, -0.830459475517273, -0.4856678247451782, -0.49285566806793213, 0.32438287138938904, 0.9614162445068359, -0.008732443675398827, 0.45177173614501953, -0.6418436765670776, 0.10463909059762955, 0.11218995600938797, -0.3463190793991089, 0.3335619568824768, 0.7812626361846924, -0.3996831476688385, -0.5181504487991333, 0.042677849531173706, 0.21757663786411285, -0.19745880365371704, -0.11085742712020874, -0.34265628457069397, -0.41516268253326416, -0.2961462438106537, 0.5655046105384827, -0.55010586977005, -0.6301993727684021, -0.2295127809047699, -0.02413126267492771, -0.5798841714859009, -0.1339349001646042, 0.012049080803990364, 0.379014790058136, 0.15068399906158447, 0.03676636144518852, -1.2464792728424072, 0.4728800654411316, 0.225021630525589, -0.4223431348800659, -0.25689706206321716, 0.07990092039108276, -0.2931828498840332, 0.0340094193816185, -0.3118077516555786, 0.46208515763282776, 0.16500800848007202, 0.11275821179151535, -1.041393756866455, -0.34053900837898254, -0.06392751634120941, -0.4711405038833618, 0.8254609704017639, 0.8224595189094543, 0.3713599443435669, -0.3261306881904602, -0.38726747035980225, -0.19232462346553802, 0.19947659969329834, 0.23839274048805237, 0.6254777312278748, -0.41146737337112427, -0.32990163564682007, 0.10306838899850845, -0.2535313665866852, 0.7103683948516846, 0.008070066571235657, -1.0859295129776, -0.04837919399142265, -0.27851659059524536, -0.4387933313846588, 0.8759805560112, 0.23130185902118683, -0.35105571150779724, 0.7191707491874695, 0.12239775061607361, 0.30921047925949097, -0.8169407248497009, 0.33326613903045654, 0.4648962616920471, 0.16543515026569366, -0.5230326056480408, 0.6981649994850159, -0.40613967180252075, -0.40071749687194824, -0.1500227004289627, 0.2950734794139862, -0.49100035429000854, 0.2897486686706543, 0.3797966539859772, 0.006533148232847452, 0.39656755328178406, 0.359663188457489, 0.00350566441193223, -0.025820350274443626, 0.2564849555492401, 0.7627500295639038, -0.533099889755249, 0.02069753222167492, 0.4930628538131714, -0.3817265033721924, -0.15333054959774017, 0.09135007858276367, 1.0069923400878906, -0.2013087272644043, 0.35748323798179626, 0.3477543592453003, -0.10189912468194962, -0.22344237565994263, -0.32682695984840393, 0.07955389469861984, -0.576866865158081, -0.3029036223888397, -0.4226343035697937, -1.011596441268921, -0.22459621727466583, 0.21006476879119873, 0.1684664636850357, -0.054557714611291885, 0.16731734573841095, -0.04138761758804321, -0.23636950552463531, 0.5747430920600891, -0.4066661298274994, -0.36209627985954285, -0.23318012058734894, -0.36142465472221375, -0.43248361349105835, 0.2061399221420288, -0.5681536793708801, 0.07878222316503525, 0.7401153445243835, 0.7263994812965393, -0.14405302703380585, 0.12075800448656082, 0.6099190711975098, 0.15545202791690826, 0.1274898648262024, 0.6804530024528503, -0.3941972851753235, -0.3317130506038666, -0.3098980486392975, 0.1544647365808487, -0.2247636616230011, 0.06796065717935562, -0.7397738695144653, -0.40902915596961975, 0.27037888765335083, 0.2894230782985687, -0.13445733487606049, 0.6463572382926941, 0.31734347343444824, -0.39847296476364136, -0.20586812496185303, 0.18253609538078308, -0.5146899819374084, 0.42944198846817017, -0.4065248966217041, 0.051872193813323975, 0.6815321445465088, 0.005898102652281523, 0.28739628195762634, -0.573288083076477, 0.03621525689959526, 0.43484562635421753, 0.2952769696712494, 0.737124502658844, 0.12766754627227783, -0.30636724829673767, 0.5957407355308533, 0.6226662993431091, -0.5066896677017212, -0.33673572540283203, 0.7697526812553406, 0.2659488022327423, -0.18207278847694397, -0.3747209906578064, 0.5045846104621887, 0.057252757251262665, -0.04787467420101166, -0.49748092889785767, -0.04339565709233284, -0.0022800022270530462, 0.2653607428073883, 0.09624524414539337, 0.8932334780693054, -0.0897849053144455, 0.3158894181251526], "query": "class MediaFileResource(ProtectedResource):\n\n    \"\"\"Resource for media files.\"\"\"\n\n    @use_args(\n        {\n            \"download\": fields.Boolean(load_default=False),\n            \"jwt\": fields.String(required=False),\n        },\n        location=\"query\",\n    )\n    def get(self, args: Dict, handle) -> Response:\n        \"\"\"Download a file.\"\"\"\n        db_handle = get_db_handle()\n        try:\n            obj = db_handle.get_media_from_handle(handle)\n        except HandleError:\n            abort(HTTPStatus.NOT_FOUND)\n        tree = get_tree_from_jwt()\n        handler = get_media_handler(db_handle, tree).get_file_handler(\n            handle, db_handle=db_handle\n        )\n        download = bool(args.get(\"download\"))\n        filename = os.path.basename(obj.path)\n        return handler.send_file(\n            etag=obj.checksum, download=download, filename=filename\n        )\n\n    @use_args(\n        {\n            \"uploadmissing\": fields.Boolean(load_default=False),\n        },\n        location=\"query\",\n    )\n    def put(self, args: Dict, handle: str) -> Response:\n        \"\"\"Upload a file and update the media object.\"\"\"\n        require_permissions([PERM_EDIT_OBJ])\n        db_handle = get_db_handle()\n        try:\n            obj: Media = db_handle.get_media_from_handle(handle)\n        except HandleError:\n            abort(HTTPStatus.NOT_FOUND)\n        checksum_old = obj.checksum\n        for etag in request.if_match:\n            if etag != checksum_old:\n                abort_with_message(412, \"ETag mismatch. Resource has been modified.\")\n        mime = request.content_type\n        if not mime:\n            abort_with_message(HTTPStatus.NOT_ACCEPTABLE, \"Media type not recognized\")\n        checksum, size, f = process_file(request.stream)\n        tree = get_tree_from_jwt()\n        media_handler = get_media_handler(db_handle, tree)\n        file_handler = media_handler.get_file_handler(handle, db_handle=db_handle)\n        if checksum == obj.checksum:\n            if not args.get(\"uploadmissing\") or file_handler.file_exists():\n                # don't allow PUTting if the file didn't change\n                abort_with_message(\n                    HTTPStatus.CONFLICT,\n                    \"Uploaded file has the same checksum as the existing media object\",\n                )\n            # we're uploading a missing file!\n            # new size will add to the quota\n            check_quota_media(to_add=size)\n            # use existing path\n            path = obj.get_path()\n            media_handler.upload_file(f, checksum, mime, path=path)\n            return Response(status=200)\n        if args.get(\"uploadmissing\"):\n            abort_with_message(\n                HTTPStatus.CONFLICT, \"Uploaded file has the wrong checksum\"\n            )\n        # we're updating an existing file\n        size_old = file_handler.get_file_size()\n        size_delta = size - size_old\n        if size_delta > 0:\n            check_quota_media(to_add=size_delta)\n        media_handler.upload_file(f, checksum, mime)\n        obj.set_checksum(checksum)\n        path = media_handler.get_default_filename(checksum, mime)\n        obj.set_path(path)\n        obj.set_mime_type(mime)\n        db_handle_writable = get_db_handle(readonly=False)\n        with DbTxn(\"Edit Media Object\", db_handle_writable) as trans:\n            try:\n                update_object(db_handle_writable, obj, trans)\n            except (AttributeError, ValueError) as exc:\n                abort_with_message(400, \"Error while updating object\")\n            trans_dict = transaction_to_json(trans)\n        update_usage_media()\n        return Response(\n            response=json.dumps(trans_dict), status=200, mimetype=\"application/json\"\n        )", "answer": "{}"}
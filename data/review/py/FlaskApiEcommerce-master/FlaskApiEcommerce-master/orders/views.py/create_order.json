{"embedding": [-0.2976163327693939, 0.37601497769355774, -0.8157175183296204, -0.33577775955200195, 0.2426791489124298, -0.6723245978355408, -0.9488223195075989, 0.22976192831993103, 0.4189773201942444, -0.5875421762466431, 0.14154815673828125, -0.11166023463010788, 0.07654843479394913, -0.2225964069366455, 0.28885364532470703, 0.6849765777587891, 0.7342835664749146, -0.4545402228832245, 0.07716484367847443, -0.1085490807890892, 0.14596636593341827, -0.1303447037935257, 0.3325769007205963, -0.12945744395256042, 0.3993091285228729, 0.048026420176029205, -0.3001360297203064, 0.800917387008667, 0.5637075901031494, -0.030627036467194557, 1.168837070465088, -0.4624418020248413, 0.518739640712738, 1.285487413406372, 0.3143082559108734, -0.21395555138587952, -0.08937695622444153, -0.04144646227359772, -0.14347079396247864, 0.2392142117023468, 0.32252103090286255, -0.08668066561222076, -0.15971384942531586, -0.0002111744979629293, 0.038492169231176376, 0.17727576196193695, -0.4227977395057678, -0.325321763753891, 0.05515405908226967, 0.3638800382614136, -0.00490420451387763, 0.14933514595031738, 0.664269745349884, -0.181426540017128, -0.06555870920419693, -0.4686567485332489, 0.05293510481715202, 0.1911398470401764, -0.3045943081378937, -0.3806752562522888, -0.24511775374412537, 0.65131676197052, 0.353275328874588, -0.4324844777584076, -0.08735574781894684, 0.3435685932636261, -0.4025406241416931, -0.47687897086143494, 0.6077350378036499, 0.5365697741508484, 0.3331485688686371, -0.23446081578731537, 0.27560192346572876, 0.19816720485687256, 0.38359829783439636, 0.8710382580757141, 0.7006900310516357, -0.37354975938796997, 0.04568810388445854, -0.3082766532897949, -0.5313625931739807, -0.43637919425964355, -0.29176193475723267, 0.8299967050552368, 0.04561462253332138, 0.38126030564308167, 0.11265131086111069, 0.5572178363800049, 0.304866224527359, -0.004675964824855328, -0.25401341915130615, 0.13815368711948395, -0.9923948645591736, 0.28073421120643616, 0.04726971685886383, -0.2762821912765503, 0.8788838982582092, -0.746842086315155, -0.08303811401128769, 0.8851110339164734, -0.04789987951517105, 0.668632984161377, -0.6284463405609131, -0.24474506080150604, 0.2695118188858032, -0.4645105302333832, 0.6303392648696899, -0.2099263221025467, -0.08348855376243591, -0.36045777797698975, 0.03296613693237305, 0.483812540769577, 0.33925002813339233, 0.07790680974721909, -0.4287883937358856, -0.00011439703666837886, 0.7703468203544617, 0.7501056790351868, -0.43644818663597107, -0.02704322524368763, 0.060669414699077606, -0.8570663332939148, 0.26170864701271057, 0.41495999693870544, 0.7070439457893372, 0.2288082093000412, -0.5066487789154053, -0.48480841517448425, 0.39710596203804016, -1.120724081993103, -0.18508046865463257, -0.5216517448425293, 0.18154948949813843, -0.01855887658894062, -0.4354522228240967, 0.5722324252128601, -0.5741857290267944, 0.05436471849679947, 0.24800200760364532, 0.8492715954780579, 0.21468517184257507, -0.20769119262695312, -0.13793693482875824, -0.5718890428543091, -0.350963294506073, 0.00741348834708333, -0.5920942425727844, -0.3501302897930145, -0.24574145674705505, -0.44093969464302063, 0.8272426128387451, 0.398561030626297, 0.4271062910556793, 0.6260490417480469, -0.35203349590301514, -0.38603734970092773, 0.0955084040760994, -0.34129735827445984, 0.4477514624595642, 0.3527805805206299, 0.16893985867500305, 0.6006103754043579, 0.8171002268791199, -0.1860097348690033, -0.4780119061470032, 0.16383419930934906, -0.05836799740791321, -0.7472524642944336, 0.05103301256895065, -0.4565882682800293, -0.3115110993385315, 0.05386757850646973, 0.4715574383735657, -0.48840707540512085, -1.2890030145645142, -0.365527480840683, 0.3462057411670685, -0.9465003609657288, -0.29297465085983276, -0.18684907257556915, -0.311470091342926, -0.3464702069759369, 0.28366878628730774, 0.5440372824668884, 0.48040738701820374, -0.5108922719955444, 0.1271066963672638, 0.30391231179237366, 1.023048996925354, 0.48407161235809326, -0.20534949004650116, 0.4675438106060028, 0.17524296045303345, -0.24622873961925507, -0.07525600492954254, 0.1482761651277542, 0.3574391007423401, -0.41406095027923584, -0.6643945574760437, 0.22026698291301727, -0.46734169125556946, -0.11473371088504791, 0.086911141872406, -0.28189221024513245, 0.4859004616737366, 0.6234108209609985, -0.48178690671920776, -0.22336265444755554, 0.3070903718471527, -0.6372740864753723, -0.30524951219558716, 0.17235027253627777, -0.6532046794891357, 0.44003918766975403, 0.028414743021130562, 0.08057993650436401, -0.02033461257815361, 0.0029897806234657764, 0.9488394260406494, 0.2826080322265625, 0.042224861681461334, -0.37956666946411133, -0.8142109513282776, -0.7565367817878723, 0.20600497722625732, 0.27898818254470825, -0.24119596183300018, 0.2939581871032715, -0.17061948776245117, 0.5040033459663391, 0.1235097199678421, 0.12961013615131378, -0.014034955762326717, 0.18087491393089294, 0.3054870367050171, -0.9272021055221558, -0.31707412004470825, -0.5018059015274048, -0.39929601550102234, 0.14974345266819, 0.1590292751789093, 0.11169232428073883, 0.2809567153453827, -0.5860058069229126, -0.30123594403266907, 0.3121843934059143, -0.4533975422382355, -0.23047341406345367, 0.4972909092903137, -0.8810198307037354, -0.6193290948867798, 0.3985794484615326, 0.34707799553871155, 0.1202041283249855, -0.14448289573192596, -0.1882055401802063, 1.1273378133773804, -0.32395079731941223, 0.015316227450966835, 0.3540275990962982, -0.6008182168006897, -0.21947798132896423, -0.35757583379745483, -0.42070209980010986, 0.005446299444884062, -0.8355408906936646, -0.5315985083580017, 0.17378078401088715, 0.13935598731040955, 0.34121474623680115, 0.4387023448944092, 0.5477340817451477, -0.04416234418749809, -0.25971195101737976, 0.11369791626930237, -0.49968186020851135, 0.24914275109767914, 0.8900993466377258, -1.1246283054351807, -0.6870444416999817, -0.2496572881937027, 0.25870734453201294, 0.3096800446510315, 0.03980892896652222, -0.2998150587081909, -0.04736126586794853, 0.2904195189476013, 1.0179383754730225, -0.010349402204155922, -0.135843887925148, -0.15075020492076874, 0.9130834937095642, 0.32459670305252075, -0.3013750910758972, -0.05409889668226242, -0.3543991446495056, -0.37681666016578674, 0.4777033030986786, 0.17872554063796997, 0.3112601935863495, -0.5002628564834595, 0.9396061897277832, 0.7784711718559265, -0.44755980372428894, 0.4078657925128937, 0.21043092012405396, 0.14903563261032104, 0.05689917504787445, -0.45194563269615173, 0.3920542001724243, -0.5552637577056885, 0.4029706120491028, 0.03254169970750809, 0.9211145639419556, 0.4926399886608124, 0.13953357934951782, 0.01907089352607727, -0.37490135431289673, 0.37169671058654785, 0.06078614667057991, -0.3271404802799225, 0.4567378759384155, 0.3825531005859375, -0.6681855320930481, 0.06129693239927292, 0.5436071157455444, -0.139146625995636, 0.5759053230285645, 0.26933664083480835, 0.5291882157325745, -0.5711444616317749, -0.12887264788150787, -0.2895815670490265, 0.957709550857544, 0.3007950782775879, -0.10044608265161514, 0.3197963833808899, -0.5044553875923157, -0.2898789644241333, -0.02704351767897606, -0.04745117574930191, -0.32156234979629517, -0.23304523527622223, 0.47118303179740906, -0.10930584371089935, -0.7139966487884521, 0.5143274664878845, -0.04178229719400406, -0.4737171232700348, -0.04940779507160187, -0.37342244386672974, -0.21312803030014038, 0.7085495591163635, 0.2877228856086731, 0.37065473198890686, -0.5429531931877136, -0.3559363782405853, -0.2595439553260803, -0.09675700217485428, 0.05684976652264595, -0.1323401778936386, -0.6128499507904053, 0.18131713569164276, 0.021281257271766663, -0.4071946442127228, -0.21253040432929993, 0.4698435664176941, -0.22305621206760406, -0.4807654917240143, 0.08123175799846649, 0.3931301534175873, -0.35939499735832214, -0.06894193589687347, 0.8599284291267395, -0.22444531321525574, 0.3873264789581299, 0.11353111267089844, -0.17504699528217316, -0.2754461467266083, 0.09582561999559402, -0.5996513366699219, -0.1610097885131836, 0.13643024861812592, -0.011710804887115955, 0.41097527742385864, -0.541572093963623, 0.860489547252655, 0.28621193766593933, -0.44842252135276794, -0.8272448778152466, -0.48494940996170044, -0.27094393968582153, 0.12880223989486694, -0.048646073788404465, 0.45188233256340027, 0.002010321943089366, -0.0003160464984830469, 0.0019127269042655826, -0.3212541937828064, 0.010915791615843773, 0.2921477258205414, -0.34121233224868774, 0.6835641860961914, 0.19016331434249878, 0.05666131153702736, -0.540300726890564, -0.48177266120910645, 0.3929276764392853, 0.7166266441345215, 0.8403407335281372, -0.05679197236895561, -0.12037031352519989, -0.02476767636835575, -0.33468788862228394, -0.5212041735649109, -0.27716439962387085, -0.10302495956420898, 0.4120396375656128, -0.005064654164016247, 0.13783806562423706, 0.8095611333847046, 0.7219933867454529, -0.028809987008571625, 0.15519976615905762, -0.2686813771724701, -0.21758849918842316, 0.34312647581100464, 0.5940755605697632, 0.3983670473098755, 0.41204532980918884, 0.12840481102466583, -0.2787708342075348, -0.22804367542266846, 0.1713244915008545, 0.8443697094917297, 0.425118088722229, 0.5805050730705261, -0.47374799847602844, -0.003339052200317383, 0.4720667600631714, 0.304564893245697, -0.2058245688676834, -0.16072267293930054, 0.03578972443938255, 0.029307862743735313, -0.4125620722770691, 0.32161617279052734, -0.8205714225769043, 1.019081711769104, 0.2674846649169922, 0.13676157593727112, -0.43837210536003113, 0.6989673972129822, -0.23668375611305237, -0.5859860181808472, -0.14450323581695557, 0.22669900953769684, -0.3321300446987152, -0.047002553939819336, 0.23704662919044495, 0.14185748994350433, -0.6202095150947571, -0.3476763665676117, 0.6289132833480835, 0.4347285032272339, 0.6268326640129089, -0.6229455471038818, 0.513397216796875, 0.21102319657802582, 0.4453604221343994, -0.14046558737754822, -0.1527952253818512, -0.5198563933372498, -0.0599152073264122, -0.25266626477241516, -0.3741568624973297, 0.5605214834213257, 0.02105148322880268, 0.1378767043352127, -0.2664072811603546, 0.5244015455245972, -0.9488005042076111, -0.3798983097076416, 0.3613048791885376, 0.2698763608932495, 0.06132098287343979, 0.6200253367424011, -0.08019984513521194, 0.7426025867462158, 0.4714566469192505, 0.03635641559958458, -0.7606409192085266, -0.1807485967874527, 0.18748609721660614, -0.11169183254241943, -0.3399752378463745, -0.4462040662765503, -0.2883405089378357, -0.11462239921092987, -1.0116841793060303, 0.4361138939857483, 0.5163917541503906, 0.3193175792694092, 0.39099499583244324, 0.02832423523068428, -0.12277127802371979, -0.7184264063835144, -0.31615689396858215, -0.029557541012763977, 0.14776094257831573, -0.19548571109771729, 0.028818735852837563, 0.4925665855407715, -0.555690586566925, 0.0489712655544281, 1.0711029767990112, -0.019156167283654213, 0.14081217348575592, -0.27187615633010864, 0.009853730909526348, 0.262849360704422, 0.04776328429579735, 0.34481820464134216, 0.22040820121765137, -0.3652859926223755, 0.396186500787735, 0.28561124205589294, 0.08149053156375885, 1.1192748546600342, 0.06287064403295517, 0.06268491595983505, 0.2488945871591568, 0.3972781002521515, 0.3415572941303253, -0.13871031999588013, -0.528251051902771, 0.3987923860549927, -0.23135694861412048, -0.4508705735206604, -0.1120949238538742, 0.4675332307815552, 0.7406057119369507, -0.5801643133163452, -1.3261306285858154, -0.8581927418708801, -0.0970604419708252, 0.23771430552005768, -0.27877485752105713, -0.627205491065979, -0.8416023254394531, 0.15640921890735626, 0.12164099514484406, 0.595691442489624, 0.2158758044242859, 0.8735340237617493, -0.30864593386650085, -0.21818654239177704, 0.14741292595863342, 0.04928714036941528, -0.2649141550064087, 0.30725714564323425, 0.22205322980880737, -0.9187379479408264, 0.5776804089546204, -0.23784390091896057, 0.014254745095968246, -0.8285350203514099, -0.17618250846862793, 0.6651062965393066, 0.34663069248199463, -0.07466543465852737, -1.0346873998641968, 0.3456294536590576, 0.7802414298057556, -0.2419223040342331, -1.0754607915878296, -0.17452438175678253, -0.03094172291457653, 0.02445034682750702, 0.1683761328458786, 0.5009248852729797, 0.0014577233232557774, -1.0159817934036255, -0.6181609630584717, 0.06168824061751366, 0.11265373229980469, 0.10057816654443741, 0.5753183364868164, 0.9674789309501648, -0.8503584861755371, 0.029413511976599693, 0.18422560393810272, -0.10183701664209366, 0.0063219317235052586, -0.14055384695529938, 0.505127489566803, -0.2107192873954773, -0.16292966902256012, -0.9307940602302551, 0.04148257523775101, -0.010084395296871662, 1.004002332687378, 0.4402543604373932, -0.29170653223991394, 0.5214844942092896, -0.2217831015586853, -0.5555284023284912, -0.675735354423523, -0.22538761794567108, -0.6466429829597473, 0.1868540197610855, -0.5138424038887024, -0.13396182656288147, -0.384072482585907, -0.46427565813064575, -0.7428415417671204, -0.19066746532917023, 0.012053409591317177, -0.09339125454425812, -0.2448352724313736, 0.13087335228919983, -0.9122127890586853, 0.005379477981477976, 0.2929908335208893, -0.1745360940694809, 0.32123130559921265, 0.22388401627540588, -0.45493027567863464, -0.24730153381824493, -0.03793317452073097, -0.2250378578901291, 0.10437042266130447, -0.07706771790981293, -0.06636001914739609, 0.623134195804596, -0.3540721833705902, -0.1808273047208786, 0.06694450229406357, 0.34900426864624023, -0.2909028232097626, -0.8862183094024658, 0.44402533769607544, -1.006314754486084, 0.33621877431869507, -0.013538021594285965, 0.6581764221191406, -0.05502909794449806, -0.957992672920227, 0.40776363015174866, -0.23015746474266052, -0.4814046323299408, 0.29915499687194824, 0.013890407048165798, 0.3728924095630646, -0.2545042335987091, 0.4075388014316559, -0.5411490797996521, -0.05823063850402832, 0.2416849136352539, 0.06243825703859329, 0.5069789290428162, 0.06321141868829727, 0.28844380378723145, -0.39165371656417847, -0.6784323453903198, 0.5168790221214294, 0.3120172917842865, -0.22292955219745636, -0.07941999286413193, 0.5423151254653931, 0.012177560478448868, 0.285770058631897, 0.6351677775382996, 0.15635798871517181, 0.10696324706077576, 0.22399848699569702, 0.26656487584114075, 0.42868897318840027, 0.40950900316238403, 0.4478972256183624, -0.22058223187923431, -0.31219184398651123, 0.5073214173316956, -0.5753566026687622, 0.039985109120607376, 0.24454228579998016, -0.2242828756570816, 0.3847372531890869, -0.0842309519648552, -0.37884530425071716, 0.26968613266944885, -0.4148077964782715, -0.15685062110424042, 0.4801030457019806, -0.5916258096694946, 0.45058655738830566, -0.48280516266822815, -0.11705562472343445, 0.2674436867237091, 0.4703942537307739, -0.09483760595321655, -0.10564752668142319, 0.4609498679637909, 0.3930418789386749, -0.3670142889022827, -0.050081510096788406, -1.108803629875183, -0.02461881935596466, 0.14684279263019562, -0.08435847610235214, 0.03449615091085434, 0.21682137250900269, 0.6212652921676636, -0.40311431884765625, -0.3679450750350952, 0.9153837561607361, 0.28342878818511963, 0.29278549551963806, -0.4260636866092682, 0.24557071924209595, -0.6087880730628967, 0.054263271391391754, -0.46325790882110596, -1.3224637508392334, 0.5471745729446411, -0.49416038393974304, -0.9405664801597595, -0.734540581703186, -0.1921452134847641, 0.14370010793209076, -0.26407742500305176, 0.5076462626457214, 0.32933539152145386, 0.1986721307039261, -0.26169639825820923, -0.5268670320510864, 0.06258562952280045, 0.21547645330429077, -0.6021981835365295, -0.03635425865650177, -0.5243089199066162, 0.03011729195713997, 0.07940614223480225, 0.41111671924591064, -0.5352319478988647, 0.2706735134124756, 0.02047952637076378, -0.3475993871688843, -0.40354040265083313, 0.4692431092262268, 0.1881047785282135, -0.040468424558639526, 0.5520133972167969, -0.02645815536379814, -0.2527986168861389, -0.008128373883664608, -0.27057620882987976, 0.4907987713813782, 0.15150046348571777, -0.3264635503292084, -1.0572210550308228, -0.46605485677719116, -0.6061471700668335, 0.0022633324842900038, 0.45872342586517334, -0.4089187979698181, 0.2213633954524994, 0.15101027488708496], "query": "def create_order():\n\n    user = current_user\n    # You can not check is user is not None because user is LocalProxy even when no authenticated\n    # to check if the user is authenticated we may do hasattr\n    user_id = user.id if hasattr(user, 'id') else None\n\n    address_id = request.json.get('address_id', None)\n\n    if address_id is not None:\n        # reusing address, the user has to be authenticated and owning that address\n        address = Address.query.filter_by(id=address_id, user_id=user_id).first()\n        if address is None:\n            return get_error_response('Permission Denied, you can not use this address', 401)\n    else:\n        first_name = request.json.get('first_name', None)\n        last_name = request.json.get('last_name', None)\n        zip_code = request.json.get('zip_code', None)\n        street_address = request.json.get('address', None)\n        country = request.json.get('address', None)\n        city = request.json.get('address', None)\n\n        if user_id is not None:\n            if first_name is None:\n                first_name = user.first_name\n\n            if last_name is None:\n                last_name = user.last_name\n\n        address = Address(first_name=first_name, last_name=last_name, city=city, country=country,\n                          street_address=street_address, zip_code=zip_code, )\n        if hasattr(user, 'id'):\n            address.user_id = user.id\n\n        db.session.add(address)\n        db.session.flush()  # we would need the address.id so let's save the address to the db to have the id\n\n    import faker\n    fake = faker.Faker()\n    order = Order(order_status=0, tracking_number=fake.uuid4(), address_id=address.id)\n    cart_items = request.json.get('cart_items')\n    product_ids = [ci['id'] for ci in cart_items]\n    products = db.session.query(Product).filter(Product.id.in_(product_ids)).all()\n    if len(products) != len(cart_items):\n        return get_error_response('Error, make sure all products you want to order are still available')\n\n    for index, product in enumerate(products):\n        order.order_items.append(OrderItem(price=product.price,\n                                           quantity=cart_items[index]['quantity'], product=product,\n                                           name=product.name,\n                                           slug=product.slug,\n                                           user_id=user_id))\n\n    db.session.add(order)\n    db.session.commit()\n    return get_success_response('Order created successfully', data=order.get_summary(include_order_items=True),\n                                status_code=200)", "answer": "{}"}
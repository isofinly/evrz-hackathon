import { createEvent, createStore } from "effector"

import { AppTheme } from "@features/settings/theme"
import { storageKeysEnum } from "@shared/constants"
import {
    blueDarkTheme,
    blueTheme,
    deepDarkTheme,
    extraDarkTheme,
    greenDarkTheme,
    greenTheme,
    mainTheme,
    violetDarkTheme,
    violetTheme,
    yellowDarkTheme,
    yellowTheme
} from "@shared/model/theme/themes"

export const themes = [
    mainTheme,
    deepDarkTheme,
    violetTheme,
    violetDarkTheme,
    blueTheme,
    blueDarkTheme,
    greenTheme,
    greenDarkTheme,
    yellowTheme,
    yellowDarkTheme,
    extraDarkTheme
]

const loadThemeFromStorage = () => <BODY loadThemeFromStorage>

export const eventChangeTheme = createEvent<AppTheme>()

export const $currentTheme = createStore<AppTheme>(loadThemeFromStorage()).on(
    eventChangeTheme,
    (_, newTheme) => newTheme
)

$currentTheme.watch(theme => {
    localStorage.setItem(storageKeysEnum.theme, theme.id)
})
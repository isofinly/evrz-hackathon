MobileColorSchemeToggler: React.FC<
	MobileColorSchemeTogglerProps
> = (props) => {
	const { className } = props;
	const [opened, handlers] = useToggle();
	// <REVIEW>переменная должна иметь явный смысл в своем названии</REVIEW>
	const { t } = useTranslation('common');
	const [ref, setRef] = React.useState<HTMLElement | null>(null);
	const [colorScheme, changeColorScheme] = useToggleColorScheme();

	const SelectedIcon = ICONS_MAP[colorScheme];

	const createOnChange = (value: colorSchemeModel.ColorScheme) => {
		return () => {
			changeColorScheme(value);
			handlers.toggleOff();
		};
	};

	const activated = t('color_schemes.activated', { scheme: colorScheme });

	return (
		<>
			<Tooltip title={activated}>
				<IconButton
					className={className}
					onClick={handlers.toggleOn}
					ref={setRef}>
					<SelectedIcon />
				</IconButton>
			</Tooltip>
			<Menu
				open={opened}
				anchorEl={ref}
				onClose={handlers.toggleOff}
				anchorOrigin={{
					horizontal: 'right',
					vertical: 'bottom',
				}}
				transformOrigin={{
					horizontal: 'right',
					vertical: 'top',
				}}
				MenuListProps={{
					disablePadding: true,
				}}>
				{SCHEMES.map((scheme) => {
					return (
						<MenuItem
							onClick={createOnChange(scheme)}
							selected={colorScheme === scheme}
							key={scheme}>
							<ListItemIcon>
								{React.createElement(ICONS_MAP[scheme])}
							</ListItemIcon>
							{t(`color_schemes.schemes.${scheme}`)}
						</MenuItem>
					);
				})}
			</Menu>
		</>
	);
}
import { Literal, Number, Record, Static, Union } from 'runtypes';

import { InRoomParams, StandardResponse } from '@/shared/types';

import { user } from '../auth';
import { room } from '../rooms';

export const invitationStatus = Union(
	Literal('sended'),
	Literal('approved'),
	Literal('rejected')
);

export type InvitationStatus = Static<typeof invitationStatus>;

export const invitation = Record({
	id: Number,
	room,
	user: user.nullable(),
	inviter: user,
	status: invitationStatus,
});

export interface Invitation extends Static<typeof invitation> <BODY Invitation>

export type GetAllInvitationsRequestParams = InRoomParams;

export type GetAllInvitationsResponseData = Promise<
	StandardResponse<Invitation[]>
>;

export interface GetInvitationViaTokenRequestParams <BODY GetInvitationViaTokenRequestParams>

export type GetInvitationViaTokenResponseData = Promise<
	StandardResponse<Invitation>
>;

export type GenerateLinkRequestParams = InRoomParams;

export type GenerateLinkResponseData = Promise<StandardResponse<string>>;

export interface InviteUserRequestParams extends InRoomParams <BODY InviteUserRequestParams>

export type InviteUserResponseData = Promise<StandardResponse<Invitation>>;

export interface ApproveInvitationRequestParams <BODY ApproveInvitationRequestParams>

export type ApproveInvitationResponseData = Promise<StandardResponse<boolean>>;

export interface RejectInvitationRequestParams <BODY RejectInvitationRequestParams>

export type RejectInvitationResponseData = Promise<StandardResponse<boolean>>;

export interface RemoveInvitationRequestParams extends InRoomParams <BODY RemoveInvitationRequestParams>

export type RemoveInvitationResponseData = Promise<StandardResponse<boolean>>;